---
title: "biathlon_data_analysis"
author: "stewarta"
date: "5 February 2018"
output: html_document
---

I asked a friend of mine who loves sports what data he would be interested in seeing in the sports domain and he answered "biathlon." I found a website that collects lots of data on the sport called [biathlonresults.com](https://biathlonresults.com/). I really look forward to the olympics this year, and France has a very famous biathlete Martin Fourcade, so that makes me keen to look more into this sport. Let's have a look!

First thing, collecting the data from the website is not that great, they provide pdfs, and all the data from all the different events are separated so there is a lot of data cleaning up involved.

# First look at the data

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(readODS)
library(knitr)
Womendf <- read.ods("WC_biathlon_women7.5k2017-18.ods", sheet = 1)
colnames(Womendf) <- Womendf[1,]
Womendf <- Womendf[2:nrow(Womendf),]
Womendf$Name <- paste(Womendf$FName, Womendf$LName, sep=" ")
Womendf <- Womendf[,c(1, 2,5:16)]
kable(head(Womendf, n=10))
```

# Length of course depending on time

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}
ggplot(Womendf, aes(x=Womendf$Res, y=as.numeric(Womendf$C_length))) + geom_point()
```

# Rank according to number of penalties

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}
library(ggplot2)
library(sqldf)
df <- sqldf("SELECT distinct Rank,sum(T) as total_penalties FROM Womendf GROUP BY Rank ORDER BY Rank")
ggplot(df, aes(x=as.numeric(df$Rank), y=df$total_penalties)) + geom_point() 

ggplot(df, aes(x=as.numeric(df$Rank), y=df$total_penalties)) + geom_point() +stat_summary(fun.data=mean_cl_normal) + geom_smooth(method='lm')
```

# rank according to num of rank points obtained in championship that year

```{r, echo=FALSE, message=FALSE, warning=FALSE}

ggplot(womenMSdf, aes(x=womenMSdf$Rank, y=womenMSdf$WC_points)) + geom_point()
```



#Number of participants per country

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
ggplot(womenMSdf, aes(x=womenMSdf$Nat)) + geom_bar()
```

#Number of penalties per country normalized per number of athletes

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(sqldf)
dfnew <- sqldf("SELECT distinct Nat,count(Nat) as num_nat,sum(num_Penalties) as num_pen FROM womenMSdf GROUP BY Nat")
ggplot(dfnew, aes(x=dfnew$Nat)) + geom_col(aes(x=dfnew$Nat, y=(dfnew$num_pen/dfnew$num_nat)))
```



```{r}

```

